{%- liquid
  assign sort_by = results.sort_by | default: results.default_sort_by
  if results.url
    assign results_url = results.url
  else
    assign terms = results.terms | escape
    assign results_url = '?q=' | append: terms | append: '&options%5Bprefix%5D=last&sort_by=' | append: sort_by
  endif
-%}
<facet-filters-form class="facets--bar aab{% if facets_desktop == 'sidebar' %} facets--bar-inline{% endif %}">
  {% if template == 'search' %}
    <div class="search-input-box">
      {%- capture description %}
		{% assign search_phrase = search.terms | replace: '*', '' %}
		{% if '' != search_phrase %}
			<p>{{ 'search.results_found' | t: count: search.results_count, key: search_phrase }}</p>
		{% endif %}
	{%- endcapture -%}
      {{ description }}
    </div>
  {% endif %}
  {%- if enable_filtering -%}
    {% render 'facets-active',
      results: results,
      results_url: results_url,
      filter_color_swatches: filter_color_swatches
    %}
  {%- endif -%}

  <form id="FacetFiltersForm-bar" class="facets__form">
    {%- if results.terms -%}
      <input type="hidden" name="q" value="{{ results.terms | escape }}">
      <input name="options[prefix]" type="hidden" value="last">
    {%- endif -%}
    {% if results.current_vendor or results.current_type %}
      <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
    {% endif %}

    <div>
      {%- if enable_filtering -%}
        {% comment %} <span class="facets-toggle filter_btn d-none">
          {{ 'products.facets.filter_and_sort' | t }}
          <div class="select-arrow">
            <svg viewBox="0 0 8 6" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6.75 1.5L3.75 4.5L0.75 1.5" stroke="var(--color-body)" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
        </span> {% endcomment %}
        <a href="#SideFilters" class="facets-toggle" id="Facets-Toggle">
          {% comment %}
            {% render 'svg-icons' with 'thb-filter' %}
            <span class="result-count" id="applied-filters-count"></span>
          {% endcomment %}
          {{ 'products.facets.filter_and_sort' | t }}
          <div class="select-arrow">
            <svg viewBox="0 0 8 6" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6.75 1.5L3.75 4.5L0.75 1.5" stroke="var(--color-body)" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
        </a>
      {%- endif -%}
    </div>
    {%- for filter in results.filters -%}
      {%- if filter.param_name == 'filter.v.availability' and filter.values[0].active -%}
        <input
          type="hidden"
          name="{{ filter.values[0].param_name }}"
          value="1"
        >
      {%- else -%}
        {%- case filter.type -%}
          {% when 'boolean', 'list' %}
            {%- for value in filter.values -%}
              {%- if value.active -%}
                <input
                  type="hidden"
                  name="{{ value.param_name }}"
                  value="{{ value.value }}"
                >
              {%- endif -%}
            {%- endfor -%}
          {% when 'price_range' %}
            {%- liquid
              assign currencies_using_comma_decimals = 'ANG,ARS,BRL,BYN,BYR,CLF,CLP,COP,CRC,CZK,DKK,EUR,HRK,HUF,IDR,ISK,MZN,NOK,PLN,RON,RUB,SEK,UYU,VES,VND' | split: ','
              assign uses_comma_decimals = false
              if currencies_using_comma_decimals contains cart.currency.iso_code
                assign uses_comma_decimals = true
              endif
            -%}
            {%- if filter.min_value.value -%}
              <input
                type="hidden"
                name="{{ filter.min_value.param_name }}"
                {%- if uses_comma_decimals -%}
                  value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                {%- else -%}
                  value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                {%- endif %}
              >
            {%- endif -%}
            {%- if filter.max_value.value -%}
              <input
                type="hidden"
                name="{{ filter.max_value.param_name }}"
                {%- if uses_comma_decimals -%}
                  value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                {%- else -%}
                  value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                {%- endif %}
              >
            {%- endif -%}
        {%- endcase -%}
      {%- endif -%}
    {% endfor %}
    <div class="thb-filter-sort-count">
      {%- if enable_sorting -%}
        <div class="thb-filter-sort">
          <div class="select">
            {%- assign sort_by = results.sort_by | default: results.default_sort_by -%}

            {% comment %}
              <select name="sort_by" class="facet-filters__sort select__select resize-select" id="SortByBar" aria-describedby="a11y-refresh-page-message">
              	{%- for option in results.sort_options -%}
                                       {% if option.value contains 'created-ascending' or option.value contains 'best-selling' or option.value contains 'price-ascending' or option.value contains 'price-descending' %}
              		<option value="{{ option.value | escape }}"{% if option.value == sort_by %} selected="selected"{% endif %}>{{ option.name | escape }}</option>
              {% endif %}
                                         {%- endfor -%}
              </select>
            {% endcomment %}
            <div class="sort-by-option">
              <!--
                <input name="sort_by" type="hidden" class="facet-filters__sort select__select resize-select" id="SortByBar" aria-describedby="a11y-refresh-page-message"/>
              -->
              <div class="SortByBar">{{ 'products.facets.sort_by_label' | t }}</div>
              {% comment %}


                <div class="sort-by-container" >
                    {%- for option in results.sort_options -%}
                        {% if option.value contains 'created-descending' or option.value contains 'best-selling' or option.value contains 'price-ascending' or option.value contains 'price-descending' %}
                            <div class="sort-option">
                                <input type="radio" name="sort_by" value="{{ option.value | escape }}" id="sort_{{ option.value }}" {% if option.value == sort_by %} checked="checked"{% endif %}>
                                <label for="sort_{{ option.value }}">{{ option.name | escape }}</label>
                            </div>
                        {% endif %}
                    {%- endfor -%}
                </div>
              {% endcomment %}
              <div class="sort-by-container">
                <div class="sort-option">
                  <input
                    type="radio"
                    {% if 'created-descending' == sort_by %}
                      checked="checked"
                    {% endif %}
                    name="sort_by"
                    value="created-descending"
                    id="sort_created-descending2"
                    onclick="applySorting(this.value)"
                  >
                  <label for="sort_created-descending2">New In</label>
                </div>
                <div class="sort-option">
                  <input
                    type="radio"
                    {% if 'best-selling' == sort_by %}
                      checked="checked"
                    {% endif %}
                    name="sort_by"
                    value="best-selling"
                    id="sort_best-selling2"
                    onclick="applySorting(this.value)"
                  >
                  <label for="sort_best-selling2">Recommended</label>
                </div>

                <div class="sort-option">
                  <input
                    type="radio"
                    {% if 'price-ascending' == sort_by %}
                      checked="checked"
                    {% endif %}
                    name="sort_by"
                    value="price-ascending"
                    id="sort_price-ascending2"
                    onclick="applySorting(this.value)"
                  >
                  <label for="sort_price-ascending2">Price - Low to High</label>
                </div>

                <div class="sort-option">
                  <input
                    type="radio"
                    {% if 'price-descending' == sort_by %}
                      checked="checked"
                    {% endif %}
                    name="sort_by"
                    value="price-descending"
                    id="sort_price-descending2"
                    onclick="applySorting(this.value)"
                  >
                  <label for="sort_price-descending2">Price - High to Low </label>
                </div>
              </div>
            </div>

            <div class="select-arrow">{%- render 'svg-icons' with 'thb-select' -%}</div>
          </div>
        </div>
      {%- endif -%}

      <div class="thb-filter-count" id="ProductCount">
        <span class="facets__label" style="    text-transform: inherit;">
          {%- if results.results_count -%}
            {{ 'search.results_with_count' | t: terms: results.terms, count: results.results_count }}
          {%- elsif results.products_count == results.all_products_count -%}
            {{ 'products.facets.product_count_simple' | t: count: results.products_count }}
          {%- else -%}
            {{
              'products.facets.product_count'
              | t: product_count: results.products_count, count: results.all_products_count
            }}
          {%- endif -%}
        </span>
        <span class="loading-overlay">
          {% render 'svg-icons' with 'thb-loading' %}
        </span>
      </div>
    </div>
  </form>
</facet-filters-form>
